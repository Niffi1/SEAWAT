C .....................................................................
C LKMT3D PACKAGE IMPLEMENTED IN IUNIT (22)
C STR1 PACKAGE IMPLEMENTED IN IUNIT (14)
C MODIFY NEXT TWO STATEMENTS IF NECESSARY
C .....................................................................
C--SEAWAT:  VARIABLE IMT3D IS SET IN MAIN20.FOR
C--SEAWAT:      IMT3D=inuhf
      IUSTR=IUNIT(14)

C--SEAWAT: SET KKSTP TO 1 FOR STANDARD LINK FILE
cwxg      IF (IMT3D.NE.INUHF) KKSTP=1

C......................................................................
C
C--SEAWAT: CHANGED THE GOTO 9999 TO AN IF STATEMENT SO THAT LKMT3.INC
C--SEAWAT: COULD BE CALLED TWICE FROM THE MAIN PROGRAM
      IF(IMT3D.NE.0) THEN
C
C--WRITE A NOTIFICATION LINE TO MODFLOW OUTPUT FILE
C--SEAWAT: COMMENTED OUT WRITE STATEMENT BECAUSE LKMT2.INC IS CALLED TWICE
C--SEAWAT: FROM MAIN PROGRAM.  COULD NOT HAVE 9990 IN TWO PLACES
C--SEAWAT:      WRITE(IOUT,9990) IMT3D
C--SEAWAT: 9990 FORMAT(/1X,'HEADS AND FLOW TERMS SAVED ON UNIT',I3,
C--SEAWAT:     & ' FOR USE BY MT3D TRANSPORT MODEL')

C--GATHER INFORMATION AND WRITE A HEADER TO THE
C--MODFLOW-MT3D LINK FILE AT THE 1ST TIME STEP
C--SEAWAT: ONLY CALL GETHEADER FOR THE TRUE MT3D LINK FILE
C--SEAWAT: NO HEADER IS USED FOR $file.umt
c IMT3D is a flag to write Standard Link File, otherwise write temp link file
c Write HEADER only when KKSTP*KKPER=1
      IF(KKPER*KKSTP.EQ.1.AND.IMT3D.EQ.IUNIT(22)) THEN
        CALL GETHEADER(IUNIT,NPER,ISS,NODES,X(LCIBOU),IUSTR,IMT3D)
      ENDIF

C
C--COLLECT AND SAVE ALL INFORMATION  for SEAWAT only
      CALL BAS1MT(X(LCHNEW),X(LCIBOU),X(LCBOT),X(LCTOP),
     &   NCOL,NROW,NLAY,KKSTP,KKPER,X(LCBUFF),IMT3D,
     &   Z(LZELEV),Z(LZPS),INUHF)
      IF(IUNIT(1).GT.0) CALL BCF2MT(X(LCHNEW),X(LCIBOU),X(LCCR),
     &   X(LCCC),X(LCCV),ISS,dtrans,X(LCSC1),X(LCSC2),X(LCHOLD),      !passing dtrans for time
     &   X(LCTOP),NCOL,NROW,NLAY,KKSTP,KKPER,
     &   X(LCBUFF),IMT3D,Z(LZPS),Z(LZELEV),INUHF,X(LCBOT),IWTABLE)
      IF(IUNIT(2).GT.0) CALL WEL1MT(NWELLS,MXWELL,
     &   X(LCWELL),X(LCIBOU),NCOL,NROW,NLAY,KKSTP,KKPER,IMT3D,INUHF)
      IF(IUNIT(3).GT.0) CALL DRN1MT(NDRAIN,MXDRN,
     &   X(LCDRAI),X(LCHNEW),NCOL,NROW,NLAY,X(LCIBOU),KKSTP,
     &   KKPER,IMT3D,Z(LZPS),Z(LZELEV),INUHF)
      IF(IUNIT(8).GT.0) CALL RCH1MT(NRCHOP,X(LCIRCH),X(LCRECH),
     &   X(LCIBOU),NROW,NCOL,NLAY,KKSTP,KKPER,X(LCBUFF),IMT3D,INUHF)
      IF(IUNIT(5).GT.0) CALL EVT2MT(NEVTOP,X(LCIEVT),X(LCEVTR),
     &   X(LCEXDP),X(LCSURF),X(LCIBOU),X(LCHNEW),NCOL,NROW,NLAY,
     &   KKSTP,KKPER,X(LCBUFF),IMT3D,Z(LZPS),Z(LZELEV),INUHF)
      IF(IUNIT(4).GT.0) CALL RIV1MT(NRIVER,MXRIVR,X(LCRIVR),X(LCIBOU),
     &   X(LCHNEW),NCOL,NROW,NLAY,KKSTP,KKPER,IMT3D,Z(LZPS),Z(LZELEV),
     &   INUHF)
      IF(IUNIT(7).GT.0) CALL GHB1MT(NBOUND,MXBND,
     &   X(LCBNDS),X(LCHNEW),NCOL,NROW,NLAY,X(LCIBOU),KKSTP,
     &   KKPER,IMT3D,Z(LZPS),Z(LZELEV),INUHF)

      ENDIF

C.......................................................................
C--END OF LKMT2.INC, last modified on 02-24-97
C.......................................................................
C
